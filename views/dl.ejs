<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        <%=name%>
    </title>
</head>

<body>
    <h1>Downloading the file momentarily...</h1>
    <h3>If the file doesn't download within 10 seconds, please <a style="color: cornflowerblue;" onclick='downloadFile("../downloads/<%=name%>", "<%=name%>");'>click here</a>.</h3>
    <script>
        function downloadFile(url, fileName) {
            fetch(url, { method: 'get', mode: 'no-cors', referrerPolicy: 'no-referrer' })
                .then(res => res.blob())
                .then(res => {
                    const aElement = document.createElement('a');
                    aElement.setAttribute('download', fileName);
                    const href = URL.createObjectURL(res);
                    aElement.href = href;
                    aElement.setAttribute('target', '_blank');
                    aElement.click();
                    URL.revokeObjectURL(href);
                });
        };
        
        setTimeout(() => {
            downloadFile("../downloads/<%=name%>", "<%=name%>");
        }, 3000);
    </script>
</body>

</html>